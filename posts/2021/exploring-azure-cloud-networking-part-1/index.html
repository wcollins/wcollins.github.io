<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Exploring Azure Cloud Networking - (Part 1) - Blog</title><meta name=Description content="Exploring the disruptive world of cloud tech"><meta property="og:title" content="Exploring Azure Cloud Networking - (Part 1)">
<meta property="og:description" content="Is cloud networking complicated, or is it just different? In building your infrastructure in the cloud, end-to-end system complexity increases exponentially. As enterprise applications mature, the foundational infrastructure and networking used to host and transport them must evolve. One obvious crux of networking is blast radius - you cannot easily modify it without down-time.
This is Part 1 of a multi-part series that will explore Azure networking. To the best of my ability, this series will be written to articulate real-world scenarios and bring attention to specifics that are critical to an understanding before diving into cloud networking architecture."><meta property="og:type" content="article"><meta property="og:url" content="http://wcollins.io/posts/2021/exploring-azure-cloud-networking-part-1/"><meta property="og:image" content="http://wcollins.io/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-04-05T14:36:06-04:00"><meta property="article:modified_time" content="2021-04-05T14:36:06-04:00"><meta property="og:site_name" content="Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://wcollins.io/"><meta name=twitter:title content="Exploring Azure Cloud Networking - (Part 1)"><meta name=twitter:description content="Is cloud networking complicated, or is it just different? In building your infrastructure in the cloud, end-to-end system complexity increases exponentially. As enterprise applications mature, the foundational infrastructure and networking used to host and transport them must evolve. One obvious crux of networking is blast radius - you cannot easily modify it without down-time.
This is Part 1 of a multi-part series that will explore Azure networking. To the best of my ability, this series will be written to articulate real-world scenarios and bring attention to specifics that are critical to an understanding before diving into cloud networking architecture."><meta name=twitter:site content="@WCollins502"><meta name=application-name content="Blog"><meta name=apple-mobile-web-app-title content="Blog"><meta name=theme-color content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><meta name=twitter:creator content="@WCollins502"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=http://wcollins.io/posts/2021/exploring-azure-cloud-networking-part-1/><link rel=prev href=http://wcollins.io/posts/2021/cloud-grade-automation-with-packer-and-terraform/><link rel=next href=http://wcollins.io/posts/2021/exploring-azure-cloud-networking-part-2/><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/color.css><link rel=stylesheet href=/css/style.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/fontawesome-free/all.min.css><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/animate/animate.min.css><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><meta name=google-site-verification content="FSCEdJZD7nAoKk16ak20hRMKNBvXlnHAU0PBBDZy5DU"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Exploring Azure Cloud Networking - (Part 1)","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"http://wcollins.io/posts/2021/exploring-azure-cloud-networking-part-1/"},"genre":"posts","keywords":"azure, cloud routing","wordcount":1170,"url":"http://wcollins.io/posts/2021/exploring-azure-cloud-networking-part-1/","datePublished":"2021-04-05T14:36:06-04:00","dateModified":"2021-04-05T14:36:06-04:00","publisher":{"@type":"Organization","name":"William Collins"},"author":{"@type":"Person","name":"William Collins"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e),document.documentElement.style.setProperty("color-scheme",e==="light"?"light":"dark"),window.theme=e,window.isDark=window.theme!=="light"}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(e){const t=document.getElementsByTagName("meta");for(let n=0;n<t.length;n++)if(t[n].getAttribute("name")===e)return t[n];return""}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"||e==="black"?setTheme(e):setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}else"light"==="light"||"light"==="dark"||"light"==="black"?(setTheme("light"),saveTheme("light")):(saveTheme("auto"),setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"));let metaColors={light:"#f8f8f8",dark:"#252627",black:"#000000"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")],window.switchThemeEventSet=new Set</script><div id=back-to-top></div><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=Blog></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/>Home </a><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/talks/>Talks </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about>About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=Blog></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/ title>Home</a><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/talks/ title>Talks</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto><nav id=TableOfContents><ul><li><a href=#core-concepts>Core Concepts</a><ul><li><a href=#common-components>Common Components</a></li></ul></li><li><a href=#basic-routing>Basic Routing</a><ul><li><a href=#subnets>Subnets</a></li><li><a href=#system-routes>System Routes</a></li><li><a href=#route-selection>Route Selection</a></li></ul></li><li><a href=#ip-addressing>IP Addressing</a><ul><li><a href=#ip-addressing-truths>IP Addressing Truths</a></li><li><a href=#planning-up-front>Planning Up Front</a></li></ul></li><li><a href=#virtual-network-peering>Virtual Network Peering</a><ul><li><a href=#peering-gone-wild>Peering Gone Wild</a></li><li><a href=#is-peering-bad>Is Peering Bad?</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Exploring Azure Cloud Networking - (Part 1)</h1><div class=post-meta><div class=post-meta-line><span class=post-author><span class="author fas fa-user-circle fa-fw"></span><a href=/ title=Author rel=author class=author>William Collins</a>
</span>&nbsp;<span class=post-category>included in </span>&nbsp;<span class=post-category>categories <a href=/categories/cloud/><i class="far fa-folder fa-fw"></i>Cloud</a>&nbsp;<a href=/categories/cloud-architecture/><i class="far fa-folder fa-fw"></i>Cloud Architecture</a>&nbsp;<a href=/categories/cloud-networking/><i class="far fa-folder fa-fw"></i>Cloud-Networking</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="5 April 2021">5 April 2021</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime="5 April 2021">5 April 2021</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1170 words&nbsp;<i class="far fa-clock fa-fw"></i>&nbsp;6 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#core-concepts>Core Concepts</a><ul><li><a href=#common-components>Common Components</a></li></ul></li><li><a href=#basic-routing>Basic Routing</a><ul><li><a href=#subnets>Subnets</a></li><li><a href=#system-routes>System Routes</a></li><li><a href=#route-selection>Route Selection</a></li></ul></li><li><a href=#ip-addressing>IP Addressing</a><ul><li><a href=#ip-addressing-truths>IP Addressing Truths</a></li><li><a href=#planning-up-front>Planning Up Front</a></li></ul></li><li><a href=#virtual-network-peering>Virtual Network Peering</a><ul><li><a href=#peering-gone-wild>Peering Gone Wild</a></li><li><a href=#is-peering-bad>Is Peering Bad?</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div><div class=content id=content><p>Is <em>cloud networking</em> complicated, or is it just different? In building your infrastructure in the cloud, <em>end-to-end</em> system complexity increases exponentially. As enterprise applications mature, the foundational infrastructure and networking used to host and transport them must evolve. One obvious crux of networking is <em>blast radius</em> - you cannot easily modify it without <em>down-time</em>.</p><p>This is <em>Part 1</em> of a multi-part series that will explore <a href=https://azure.microsoft.com/en-us/ target=_blank rel="noopener noreferrer">Azure</a> networking. To the best of my ability, this series will be written to articulate <em>real-world</em> scenarios and bring attention to specifics that are critical to an understanding before diving into <em>cloud networking</em> architecture. Even in working through basics, sometimes a simple thing can be overlooked, which carries long-lasting implications over time.</p><p><figure><a class=lightgallery href=/posts/2021/exploring-azure-cloud-networking-part-1/azure-networking-overview.png title="Azure Networking - Overview" data-thumbnail=/posts/2021/exploring-azure-cloud-networking-part-1/azure-networking-overview.png data-sub-html="<h2>Overview</h2><p>Azure Networking - Overview</p>"><img loading=lazy src=/posts/2021/exploring-azure-cloud-networking-part-1/azure-networking-overview.png srcset="/posts/2021/exploring-azure-cloud-networking-part-1/azure-networking-overview.png, /posts/2021/exploring-azure-cloud-networking-part-1/azure-networking-overview.png 1.5x, /posts/2021/exploring-azure-cloud-networking-part-1/azure-networking-overview.png 2x" sizes=auto alt="Azure Networking - Overview" height=1721 width=2792></a><figcaption class=image-caption>Overview</figcaption></figure></p><h2 id=core-concepts class=headerLink><a href=#core-concepts class=header-mark></a>Core Concepts</h2><p>New and shiny services like <a href=https://docs.microsoft.com/en-us/azure/virtual-wan/virtual-wan-about target=_blank rel="noopener noreferrer">Virtual WAN</a> and <a href=https://azure.microsoft.com/en-us/services/route-server/ target=_blank rel="noopener noreferrer">Route Server</a> will continually be released as capabilities evolve. While new services and features are released to make life easier, some things rarely change. A few core network components are always required when deploying just about any application.</p><h3 id=common-components class=headerLink><a href=#common-components class=header-mark></a>Common Components</h3><p>In the cloud, you generally have a hierarchy in which logical components exist, which may contain additional logical components. With Azure, for instance, <a href=https://docs.microsoft.com/en-us/azure/governance/management-groups/overview target=_blank rel="noopener noreferrer">Management Groups</a> include Subscriptions. <a href=https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/decision-guides/subscriptions/ target=_blank rel="noopener noreferrer">Subscriptions</a> hold Resource Groups, which is where <a href=https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview target=_blank rel="noopener noreferrer">Virtual Networks</a> live. A VNet may be a shared resource across many apps and services in scope across many teams.</p><ul><li><a href=https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/manage-resource-groups-portal target=_blank rel="noopener noreferrer">Resource Groups</a> are containers that hold common objects; An example might be all resources and services which make up an application</li><li><a href=https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview target=_blank rel="noopener noreferrer">Virtual Networks (VNets)</a> enable connectivity between your resources, forming the foundation you need to run applications in the cloud</li><li><a href=https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-vnet-plan-design-arm#subnets target=_blank rel="noopener noreferrer">Subnets</a> are created from the <em>address space</em> defined at the VNet level; This allows a VNet to be segmented as needed</li><li><a href=https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-udr-overview#custom-routes target=_blank rel="noopener noreferrer">User-Defined Routes (UDRs)</a> are simply static routes that override Azure&rsquo;s default system routes or add additional routes to a subnet&rsquo;s route table; A given subnet can have <strong>0</strong> or <strong>1</strong> route tables associated with it</li></ul><p><figure><a class=lightgallery href=/posts/2021/exploring-azure-cloud-networking-part-1/common-components.png title="Common Components" data-thumbnail=/posts/2021/exploring-azure-cloud-networking-part-1/common-components.png data-sub-html="<h2>Components</h2><p>Common Components</p>"><img loading=lazy src=/posts/2021/exploring-azure-cloud-networking-part-1/common-components.png srcset="/posts/2021/exploring-azure-cloud-networking-part-1/common-components.png, /posts/2021/exploring-azure-cloud-networking-part-1/common-components.png 1.5x, /posts/2021/exploring-azure-cloud-networking-part-1/common-components.png 2x" sizes=auto alt="Common Components" height=1494 width=2700></a><figcaption class=image-caption>Components</figcaption></figure></p><h2 id=basic-routing class=headerLink><a href=#basic-routing class=header-mark></a>Basic Routing</h2><p>Knowing how Azure routes traffic between virtual networks, on-premises, and over the Internet is <strong>good</strong> knowledge to have. Understanding how you can override certain default behaviors is <strong>excellent</strong> knowledge to have. Putting these things together to build a network that enables business outcomes should be the goal.</p><h3 id=subnets class=headerLink><a href=#subnets class=header-mark></a>Subnets</h3><p>In <a href=https://azure.microsoft.com/en-us/ target=_blank rel="noopener noreferrer">Azure</a> and <a href=https://aws.amazon.com/ target=_blank rel="noopener noreferrer">AWS</a>, VPCs and VNets are limited to a single Region. This is about where the similarities stop. With AWS, a subnet is limited to a single <a href=https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html target=_blank rel="noopener noreferrer">availability zone</a> while Azure extends a single subnet across all <a href=https://docs.microsoft.com/en-us/azure/availability-zones/az-overview#availability-zones target=_blank rel="noopener noreferrer">availability zones</a>.</p><h3 id=system-routes class=headerLink><a href=#system-routes class=header-mark></a>System Routes</h3><p><a href=https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-udr-overview#system-routes target=_blank rel="noopener noreferrer">System Routes</a> are automatically created and assigned to each subnet. You cannot create system routes, nor can you remove them. A default routing table for a new subnet in Azure would look something like this:</p><table><thead><tr><th>Source</th><th>Address Prefixes</th><th>Next Hop Type</th></tr></thead><tbody><tr><td>Default</td><td>Address Space (assigned at provision time)</td><td>Virtual Network</td></tr><tr><td>Default</td><td>0.0.0.0/0</td><td>Internet</td></tr><tr><td>Default</td><td>10.0.0.0/8</td><td>None</td></tr><tr><td>Default</td><td>192.168.0.0/16</td><td>None</td></tr><tr><td>Default</td><td>100.64.0.0/10</td><td>None</td></tr></tbody></table><p><em>Next Hop Types</em> are self-explanatory. The type <strong>Virtual Network</strong> routes traffic between address ranges carved out from the <em>VNet&rsquo;s</em> address space. For internet egress, type <strong>Internet</strong> is used. If you want to <strong>Null</strong> route traffic, type <strong>None</strong> is used; Traffic will be discarded.</p><blockquote><p>You can validate effective routes via <a href=https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-network-interface#view-network-interface-settings target=_blank rel="noopener noreferrer">network interface settings</a> or <a href=https://docs.microsoft.com/en-us/azure/virtual-network/manage-route-table#view-details-of-a-route-table target=_blank rel="noopener noreferrer">route tables</a>.</p></blockquote><h3 id=route-selection class=headerLink><a href=#route-selection class=header-mark></a>Route Selection</h3><p>How exactly does route selection in <a href=https://azure.microsoft.com/en-us/ target=_blank rel="noopener noreferrer">Azure</a> work? With traffic exiting a given subnet, a decision must be made based on the destination IP Address. Azure makes this decision based <a href=https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-udr-overview#how-azure-selects-a-route target=_blank rel="noopener noreferrer">on the longest prefix.</a> If multiple routes contain the same address prefix, the tie is broken based on the following priority:</p><ol><li><a href=https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-udr-overview#custom-routes target=_blank rel="noopener noreferrer">User Defined Routes (Custom)</a></li><li><a href=https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-udr-overview#border-gateway-protocol target=_blank rel="noopener noreferrer">Border Gateway Protocol (BGP)</a></li><li><a href=https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-udr-overview#system-routes target=_blank rel="noopener noreferrer">System Route (Default)</a></li></ol><p><figure><a class=lightgallery href=/posts/2021/exploring-azure-cloud-networking-part-1/longest-prefix-wins.png title="Longest Prefix Wins" data-thumbnail=/posts/2021/exploring-azure-cloud-networking-part-1/longest-prefix-wins.png data-sub-html="<h2>Longest Prefix</h2><p>Longest Prefix Wins</p>"><img loading=lazy src=/posts/2021/exploring-azure-cloud-networking-part-1/longest-prefix-wins.png srcset="/posts/2021/exploring-azure-cloud-networking-part-1/longest-prefix-wins.png, /posts/2021/exploring-azure-cloud-networking-part-1/longest-prefix-wins.png 1.5x, /posts/2021/exploring-azure-cloud-networking-part-1/longest-prefix-wins.png 2x" sizes=auto alt="Longest Prefix Wins" height=681 width=2636></a><figcaption class=image-caption>Longest Prefix</figcaption></figure></p><blockquote><p>System Routes for VNet peering is always a preferred route, even if BGP routes are more specific. This is a small but critical detail as a design evolves.</p></blockquote><h2 id=ip-addressing class=headerLink><a href=#ip-addressing class=header-mark></a>IP Addressing</h2><p>Some decisions age like fine wine, while others seem to age like sour milk. An area that comes to mind here is <strong>IP Address Planning</strong>. Taking some time to plan out your <em>IP Addressing Scheme</em> upfront can go a long way.</p><h3 id=ip-addressing-truths class=headerLink><a href=#ip-addressing-truths class=header-mark></a>IP Addressing Truths</h3><p>There is no <em>one size fits all</em> here. A few things that are general truths include:</p><ol><li>IP Addressing Scheme should match the topology or vice versa</li><li>VNet Address Space cannot be <a href="https://docs.Microsoft.com/en-us/azure/architecture/networking/prefixes/add-ip-space-peered-vnet#:~:text=Many%20organizations%20deploy%20a%20virtual,the%20Hub%20and%20Spoke%20model.&amp;text=However%2C%20address%20ranges%20can%27t,peered%20with%20another%20virtual%20network." target=_blank rel="noopener noreferrer">added, modified, or removed</a> if a VNet peer is established</li><li>Design dictates consumption; Good automation becomes difficult with poorly planned designs</li><li><em>IP Addressing</em> and <em>Segmentation</em> is a collaborative exercise; Align with the Security Overlords</li></ol><h3 id=planning-up-front class=headerLink><a href=#planning-up-front class=header-mark></a>Planning Up Front</h3><p>Let&rsquo;s use Healthcare as an example. Privacy is critical, and <a href=https://www.cdc.gov/phlp/publications/topic/hipaa.html target=_blank rel="noopener noreferrer">HIPAA</a> sets clear guidelines on the use and release of health records. If your business deals with protected information, then <em>data classification</em> is a great place to start. If you have a combination of applications (some leveraging protected information and some that do not), both categories can be treated fundamentally differently.</p><p><figure><a class=lightgallery href=/posts/2021/exploring-azure-cloud-networking-part-1/ip-scheme-overview.png title="IP Addressing Scheme" data-thumbnail=/posts/2021/exploring-azure-cloud-networking-part-1/ip-scheme-overview.png data-sub-html="<h2>Addressing Scheme</h2><p>IP Addressing Scheme</p>"><img loading=lazy src=/posts/2021/exploring-azure-cloud-networking-part-1/ip-scheme-overview.png srcset="/posts/2021/exploring-azure-cloud-networking-part-1/ip-scheme-overview.png, /posts/2021/exploring-azure-cloud-networking-part-1/ip-scheme-overview.png 1.5x, /posts/2021/exploring-azure-cloud-networking-part-1/ip-scheme-overview.png 2x" sizes=auto alt="IP Addressing Scheme" height=801 width=2723></a><figcaption class=image-caption>Addressing Scheme</figcaption></figure></p><p>The above example puts <strong>data classification</strong> at center stage. If you can categorize all of your <em>protected data</em> at a higher level, this simplifies the work required to ensure compliance. Think of it like this:</p><ol><li>Protected Data can only exist in the <strong>Production (With Protected Data)</strong> segment</li><li>An alternative <strong>Production</strong> segment exists for workloads not requiring access to Protected Data</li><li><strong>Non-Production</strong> exists for all <em>lower-stage</em> environments across both <strong>Production</strong> segments; Synthetic Data enables rapid prototyping of heavily regulated data in lower-stage environments (Preventing the risk of accidental exposure)</li></ol><h2 id=virtual-network-peering class=headerLink><a href=#virtual-network-peering class=header-mark></a>Virtual Network Peering</h2><p>At some point, connectivity between two or more virtual networks is going to become a requirement. As you grow, chances are, your virtual network footprint will expand significantly. <a href=https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-peering-overview target=_blank rel="noopener noreferrer">Virtual Network Peering</a> enables connectivity between two or more virtual networks. The big caveat with peering is, virtual networks natively are <em>none-transitive</em>. This means, if you have 3 VNets, you can&rsquo;t route from <strong>VNet: A</strong> to <strong>VNet: C</strong> through <strong>VNet: B</strong>.</p><p><figure><a class=lightgallery href=/posts/2021/exploring-azure-cloud-networking-part-1/transitive-routing.png title="Transitive Routing" data-thumbnail=/posts/2021/exploring-azure-cloud-networking-part-1/transitive-routing.png data-sub-html="<h2>Transitive Routing</h2><p>Transitive Routing</p>"><img loading=lazy src=/posts/2021/exploring-azure-cloud-networking-part-1/transitive-routing.png srcset="/posts/2021/exploring-azure-cloud-networking-part-1/transitive-routing.png, /posts/2021/exploring-azure-cloud-networking-part-1/transitive-routing.png 1.5x, /posts/2021/exploring-azure-cloud-networking-part-1/transitive-routing.png 2x" sizes=auto alt="Transitive Routing" height=1161 width=2327></a><figcaption class=image-caption>Transitive Routing</figcaption></figure></p><h3 id=peering-gone-wild class=headerLink><a href=#peering-gone-wild class=header-mark></a>Peering Gone Wild</h3><p>Without giving network peering more thought, common sense may imply just peering VNets which require communication. So, we peer every virtual network with every other virtual network. What is the worst that could happen? I like <em>spaghetti</em> myself, but I don&rsquo;t think of it as a design principle when building my networks!</p><p><figure><a class=lightgallery href=/posts/2021/exploring-azure-cloud-networking-part-1/full-mesh-peering.png title="Full Mesh - Peering" data-thumbnail=/posts/2021/exploring-azure-cloud-networking-part-1/full-mesh-peering.png data-sub-html="<h2>Full Mesh</h2><p>Full Mesh - Peering</p>"><img loading=lazy src=/posts/2021/exploring-azure-cloud-networking-part-1/full-mesh-peering.png srcset="/posts/2021/exploring-azure-cloud-networking-part-1/full-mesh-peering.png, /posts/2021/exploring-azure-cloud-networking-part-1/full-mesh-peering.png 1.5x, /posts/2021/exploring-azure-cloud-networking-part-1/full-mesh-peering.png 2x" sizes=auto alt="Full Mesh - Peering" height=2113 width=2344></a><figcaption class=image-caption>Full Mesh</figcaption></figure></p><h3 id=is-peering-bad class=headerLink><a href=#is-peering-bad class=header-mark></a>Is Peering Bad?</h3><p>No, peering is not bad. Like any feature, you should think through how it is used to provide the outcomes you want. Also, try hard not to over-extend it to do things that it was not designed to do. If you are peering everything with everything, then maybe the problem that needs to be solved is transitive routing. In thinking through VNet peering, some obvious things come to mind:</p><ul><li><strong>Cost</strong> - <a href=https://azure.microsoft.com/en-us/pricing/details/virtual-network/ target=_blank rel="noopener noreferrer">Inbound/Outbound Charges</a></li><li><strong>Reliability</strong> - A failure occurs with a connection; How would redundancy or mitigation work?</li><li><strong>Operations</strong> - As new VNets are added, overhead and complexity grows exponentially</li><li><strong>Security</strong> - Least privilege is real; <em>What can talk to what</em> now shifts to <a href=https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-udr-overview#user-defined target=_blank rel="noopener noreferrer">UDRs</a> and <a href=https://docs.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview target=_blank rel="noopener noreferrer">NSGs</a></li></ul><h2 id=conclusion class=headerLink><a href=#conclusion class=header-mark></a>Conclusion</h2><p>Now that we have a basic understanding of foundational network components, what&rsquo;s next? For <a href=https://wcollins.io/posts/2021/exploring-azure-cloud-networking-part-2/ target=_blank rel="noopener noreferrer">Part 2</a>, we will go through the evolution of common network patterns ranging from <em>my own little desert island</em>, to modern <em>hub-and-spoke</em> designs that we see today in larger environments.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 5 April 2021</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-mardown href=/posts/2021/exploring-azure-cloud-networking-part-1/index.md target=_blank rel="noopener noreferrer">Read markdown</a></span></div><div class=post-info-share></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/azure/>Azure</a>,&nbsp;<a href=/tags/cloud-routing/>Cloud Routing</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/2021/cloud-grade-automation-with-packer-and-terraform/ class=prev rel=prev title="Cloud Grade Automation With Packer and Terraform"><i class="fas fa-angle-left fa-fw"></i>Cloud Grade Automation With Packer and Terraform</a>
<a href=/posts/2021/exploring-azure-cloud-networking-part-2/ class=next rel=next title="Exploring Azure Cloud Networking - (Part 2)">Exploring Azure Cloud Networking - (Part 2)<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2019 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank rel="noopener noreferrer">William Collins</a></span></div><div class=footer-line></div><div class=footer-line></div></div></footer></div><div id=fixed-buttons><a href=#back-to-top id=back-to-top-button class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><div class=assets><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.css><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},lightGallery:{actualSize:!1,exThumbImage:"data-thumbnail",hideBarsDelay:2e3,selector:".lightgallery",speed:400,thumbContHeight:80,thumbWidth:80,thumbnail:!0},search:{distance:null,findAllMatches:null,fuseIndexURL:"/index.json",highlightTag:"em",ignoreFieldNorm:null,ignoreLocation:null,isCaseSensitive:null,location:null,maxResultLength:10,minMatchCharLength:null,noResultsFound:"No results found",snippetLength:30,threshold:null,type:"fuse",useExtendedSearch:null}}</script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/js/theme.min.js defer></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9QKVT40M3H")</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-9QKVT40M3H" async></script></div></body></html>
<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>AnsibleFest 2020 - Automating IPAM In Cloud &#183; William Collins</title><meta name=title content="AnsibleFest 2020 - Automating IPAM In Cloud &#183; William Collins"><meta name=description content="Cloud architecture, automation, AI, and the human perspective in tech"><meta name=keywords content="ansible,azure,terraform,"><link rel=canonical href=https://wcollins.io/posts/2020/automating-cloud-ipam/><meta name=author content="William Collins"><link href=https://linkedin.com/in/william-collins rel=me><link href=https://github.com/wcollins rel=me><link href=https://x.com/MacroEngineered rel=me><link href=https://youtube.com/@MacroEngineered rel=me><link href=https://wcollins.io/index.xml rel=me><meta property="og:url" content="https://wcollins.io/posts/2020/automating-cloud-ipam/"><meta property="og:site_name" content="William Collins"><meta property="og:title" content="AnsibleFest 2020 - Automating IPAM In Cloud"><meta property="og:description" content="AnsibleFest AnsibleFest 2020, like most conferences this year, took place completely virtual. I presented on Automating IPAM In Cloud: Ansible + Netbox. You can find the slides along with the demonstration code in this git repo. In this post, I’m going to expand a little further on the content I presented."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-13T07:16:08-04:00"><meta property="article:modified_time" content="2020-10-13T07:16:08-04:00"><meta property="article:tag" content="Ansible"><meta property="article:tag" content="Azure"><meta property="article:tag" content="Terraform"><meta property="og:image" content="https://wcollins.io/posts/2020/automating-cloud-ipam/featured.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://wcollins.io/posts/2020/automating-cloud-ipam/featured.png"><meta name=twitter:title content="AnsibleFest 2020 - Automating IPAM In Cloud"><meta name=twitter:description content="AnsibleFest AnsibleFest 2020, like most conferences this year, took place completely virtual. I presented on Automating IPAM In Cloud: Ansible + Netbox. You can find the slides along with the demonstration code in this git repo. In this post, I’m going to expand a little further on the content I presented."><meta name=google-site-verification content="FSCEdJZD7nAoKk16ak20hRMKNBvXlnHAU0PBBDZy5DU"><link type=text/css rel=stylesheet href=/css/main.bundle.min.40aab530da19413a510e31baf7eed4ff0d9f6798ebaf36f337e76577207750e02527c69574ac2dddf922b727d18d337e85a9a85485366d4622702df1c051b344.css integrity="sha512-QKq1MNoZQTpRDjG69+7U/w2fZ5jrrzbzN+dldyB3UOAlJ8aVdKwt3fkityfRjTN+hamoVIU2bUYicC3xwFGzRA=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.7c94d05297ae0b7db7a9476c8d132bc35cc6d9f91a1b85bce0cd8f7d4d38e82cfc33872123c12164508e21717ae94d8e417a837b8d09f94ed81736f4506cb942.js integrity="sha512-fJTQUpeuC323qUdsjRMrw1zG2fkaG4W84M2PfU046Cz8M4chI8EhZFCOIXF66U2OQXqDe40J+U7YFzb0UGy5Qg==" data-copy=Copy data-copied=Copied></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"AnsibleFest 2020 - Automating IPAM In Cloud","headline":"AnsibleFest 2020 - Automating IPAM In Cloud","inLanguage":"en","url":"https://wcollins.io/posts/2020/automating-cloud-ipam/","author":{"@type":"Person","name":"William Collins"},"copyrightYear":"2020","dateCreated":"2020-10-13T07:16:08-04:00","datePublished":"2020-10-13T07:16:08-04:00","dateModified":"2020-10-13T07:16:08-04:00","keywords":["ansible","azure","terraform"],"mainEntityOfPage":"true","wordCount":"2026"},{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wcollins.io/posts/"},{"@type":"ListItem","position":2,"name":"AnsibleFest 2020 - Automating IPAM In Cloud","item":"https://wcollins.io/posts/2020/automating-cloud-ipam/"}]}]</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-9QKVT40M3H"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9QKVT40M3H")</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral bf-scrollbar"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl bg-neutral/25 dark:bg-neutral-800/25"></div><div class="relative m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32"><div class="main-menu flex items-center w-full gap-2 p-1 pl-0"><a href=/ class="flex items-center gap-1.5 text-base font-medium truncate min-w-0 shrink"><svg viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4 shrink-0"><path fill-rule="evenodd" d="M9.293 2.293a1 1 0 011.414.0l7 7A1 1 0 0117 11h-1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-3a1 1 0 00-1-1H9a1 1 0 00-1 1v3a1 1 0 01-1 1H5a1 1 0 01-1-1v-6H3a1 1 0 01-.707-1.707l7-7z" clip-rule="evenodd"/></svg>
William Collins</a><div class="flex items-center ms-auto"><div class="hidden md:flex"><nav class="flex items-center gap-x-5 h-12"><a href=/posts/ class="flex items-center bf-icon-color-hover" aria-label=Posts title=Posts><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M421.7 220.3 188.5 453.4l-33.9-33.9 3.5-3.5H112C103.2 416 96 408.8 96 4e2V353.9l-3.49 3.5C87.78 362.2 84.31 368 82.42 374.4L59.44 452.6l78.16-23C143.1 427.7 149.8 424.2 154.6 419.5l33.9 33.9c-10.4 10.4-23.3 18.1-37.4 22.2L30.77 511C22.35 513.5 13.24 511.2 7.03 504.1.8198 498.8-1.502 489.7.976 481.2L36.37 360.9c4.16-14.1 11.79-27 22.2-37.4L291.7 90.34l130 129.96zm71-161.55C517.7 83.74 517.7 124.3 492.7 149.3l-48.4 48.4-130-129.98 48.4-48.4c25-24.998 65.6-24.998 90.6.0l39.4 39.43z"/></svg>
</span></span><span class="text-base font-medium break-normal">Posts
</span></a><a href=/talks/ class="flex items-center bf-icon-color-hover" aria-label=Talks title="Talks & Media"><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 32C114.6 32 .0272 125.1.0272 240c0 49.63 21.35 94.98 56.97 130.7-12.5 50.37-54.27 95.27-54.77 95.77-2.25 2.25-2.875 5.734-1.5 8.734C1.979 478.2 4.75 480 8 480c66.25.0 115.1-31.76 140.6-51.39C181.2 440.9 217.6 448 256 448c141.4.0 255.1-93.13 255.1-208S397.4 32 256 32z"/></svg>
</span></span><span class="text-base font-medium break-normal">Talks
</span></a><a href=/projects/ class="flex items-center bf-icon-color-hover" aria-label=Projects title=Projects><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8.0 45.3L562.7 256l-89.4 89.4c-12.5 12.5-12.5 32.8.0 45.3s32.8 12.5 45.3.0l112-112c12.5-12.5 12.5-32.8.0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3.0zm-306.7.0c-12.5-12.5-32.8-12.5-45.3.0l-112 112c-12.5 12.5-12.5 32.8.0 45.3l112 112c12.5 12.5 32.8 12.5 45.3.0s12.5-32.8.0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8.0-45.3z"/></svg></span>
</span><span class="text-base font-medium break-normal">Projects
</span></a><a href=/about/ class="flex items-center bf-icon-color-hover" aria-label=About title=About><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M266.3 48.3 232.5 73.6c-5.4 4-8.5 10.4-8.5 17.1v9.1c0 6.8 5.5 12.3 12.3 12.3 2.4.0 4.8-.7 6.8-2.1l41.8-27.9c2-1.3 4.4-2.1 6.8-2.1h1c6.2.0 11.3 5.1 11.3 11.3.0 3-1.2 5.9-3.3 8l-19.9 19.9c-5.8 5.8-12.9 10.2-20.7 12.8l-26.5 8.8c-5.8 1.9-9.6 7.3-9.6 13.4.0 3.7-1.5 7.3-4.1 10L202 182.1c-6.4 6.4-9.9 15-9.9 24v4.3c0 16.4 13.6 29.7 29.9 29.7 11 0 21.2-6.2 26.1-16l4-8.1c2.4-4.8 7.4-7.9 12.8-7.9 4.5.0 8.7 2.1 11.4 5.7l16.3 21.7c2.1 2.9 5.5 4.5 9.1 4.5 8.4.0 13.9-8.9 10.1-16.4l-1.1-2.3c-3.5-7 0-15.5 7.5-18l21.2-7.1c7.6-2.5 12.7-9.6 12.7-17.6.0-10.3 8.3-18.6 18.6-18.6H4e2c8.8.0 16 7.2 16 16s-7.2 16-16 16H379.3c-7.2.0-14.2 2.9-19.3 8l-4.7 4.7c-2.1 2.1-3.3 5-3.3 8 0 6.2 5.1 11.3 11.3 11.3h11.3c6 0 11.8 2.4 16 6.6l6.5 6.5c1.8 1.8 2.8 4.3 2.8 6.8s-1 5-2.8 6.8l-7.5 7.5C386 262 384 266.9 384 272s2 10 5.7 13.7L408 304c10.2 10.2 24.1 16 38.6 16H454c6.5-20.2 10-41.7 10-64 0-111.4-87.6-202.4-197.7-207.7zm172 307.9c-3.7-2.6-8.2-4.1-13-4.1-6 0-11.8-2.4-16-6.6L396 332c-7.7-7.7-18-12-28.9-12-9.7.0-19.2-3.5-26.6-9.8L314 287.4c-11.6-9.9-26.4-15.4-41.6-15.4h-21c-12.6.0-25 3.7-35.5 10.7L188.5 301c-17.8 11.9-28.5 31.9-28.5 53.3v3.2c0 17 6.7 33.3 18.7 45.3l16 16c8.5 8.5 20 13.3 32 13.3H248c13.3.0 24 10.7 24 24 0 2.5.4 5 1.1 7.3 71.3-5.8 132.5-47.6 165.2-107.2zM0 256a256 256 0 11512 0A256 256 0 110 256zM187.3 100.7c-6.2-6.2-16.4-6.2-22.6.0l-32 32c-6.2 6.2-6.2 16.4.0 22.6s16.4 6.2 22.6.0l32-32c6.2-6.2 6.2-16.4.0-22.6z"/></svg></span>
</span><span class="text-base font-medium break-normal">About
</span></a><a href=/links/ class="flex items-center bf-icon-color-hover" aria-label=Links title=Links><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M172.5 131.1c55.6-55.59 148-55.59 203.6.0 50 50 57.4 129.7 16.3 187.2L391.3 319.9C381 334.2 361 337.6 346.7 327.3c-14.4-10.3-17.8-30.3-7.5-44.6L340.3 281.1C363.2 249 359.6 205.1 331.7 177.2c-31.4-31.4-82.5-31.4-114 0L105.5 289.5c-31.51 30.6-31.51 82.5.0 114C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4 265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2c-58.4 41.1-136.3 34.5-186.29-15.4-56.469-56.5-56.469-148.1.0-204.5L172.5 131.1zM467.5 380c-56.5 56.5-148 56.5-204.5.0-50-50-56.5-128.8-15.4-186.3L248.7 192.1C258.1 177.8 278.1 174.4 293.3 184.7 307.7 194.1 311.1 214.1 300.8 229.3L299.7 230.9C276.8 262.1 280.4 306.9 308.3 334.8c31.4 31.4 82.5 31.4 114 0L534.5 222.5c31.5-31.5 31.5-83.4.0-114C506.7 80.63 462.7 76.99 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58 374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.731 529.8 13.25 579.8 63.24c56.5 56.46 56.5 148.06.0 204.46L467.5 380z"/></svg>
</span></span><span class="text-base font-medium break-normal">Links
</span></a><button id=search-button aria-label=Search class="text-base bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base bf-icon-color-hover"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav></div><div class="flex md:hidden"><div class="flex items-center h-14 gap-4"><button id=search-button-mobile aria-label=Search class="flex items-center justify-center bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile type=button aria-label="Dark mode switcher" class="flex items-center justify-center text-neutral-900 hover:text-primary-600 dark:text-neutral-200 dark:hover:text-primary-400"><div class=dark:hidden><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="hidden dark:block"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button>
<input type=checkbox id=mobile-menu-toggle autocomplete=off class="hidden peer">
<label for=mobile-menu-toggle class="flex items-center justify-center cursor-pointer bf-icon-color-hover"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></label><div role=dialog aria-modal=true style=scrollbar-gutter:stable class="fixed inset-0 z-50 invisible overflow-y-auto px-6 py-20 opacity-0 transition-[opacity,visibility] duration-300 peer-checked:visible peer-checked:opacity-100 bg-neutral-50/97 dark:bg-neutral-900/99
bf-scrollbar"><label for=mobile-menu-toggle class="fixed end-8 top-5 flex items-center justify-center z-50 h-12 w-12 cursor-pointer select-none rounded-full bf-icon-color-hover border bf-border-color bf-border-color-hover bg-neutral-50 dark:bg-neutral-900"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></label><nav class="mx-auto max-w-md space-y-6"><div class=px-2><a href=/posts/ aria-label=Posts class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span class="flex items-center justify-center h-8 w-8 text-2xl"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M421.7 220.3 188.5 453.4l-33.9-33.9 3.5-3.5H112C103.2 416 96 408.8 96 4e2V353.9l-3.49 3.5C87.78 362.2 84.31 368 82.42 374.4L59.44 452.6l78.16-23C143.1 427.7 149.8 424.2 154.6 419.5l33.9 33.9c-10.4 10.4-23.3 18.1-37.4 22.2L30.77 511C22.35 513.5 13.24 511.2 7.03 504.1.8198 498.8-1.502 489.7.976 481.2L36.37 360.9c4.16-14.1 11.79-27 22.2-37.4L291.7 90.34l130 129.96zm71-161.55C517.7 83.74 517.7 124.3 492.7 149.3l-48.4 48.4-130-129.98 48.4-48.4c25-24.998 65.6-24.998 90.6.0l39.4 39.43z"/></svg>
</span></span><span title=Posts class="text-2xl font-bold tracking-tight">Posts</span></a></div><div class=px-2><a href=/talks/ aria-label=Talks class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span class="flex items-center justify-center h-8 w-8 text-2xl"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 32C114.6 32 .0272 125.1.0272 240c0 49.63 21.35 94.98 56.97 130.7-12.5 50.37-54.27 95.27-54.77 95.77-2.25 2.25-2.875 5.734-1.5 8.734C1.979 478.2 4.75 480 8 480c66.25.0 115.1-31.76 140.6-51.39C181.2 440.9 217.6 448 256 448c141.4.0 255.1-93.13 255.1-208S397.4 32 256 32z"/></svg>
</span></span><span title="Talks & Media" class="text-2xl font-bold tracking-tight">Talks</span></a></div><div class=px-2><a href=/projects/ aria-label=Projects class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span class="flex items-center justify-center h-8 w-8 text-2xl"><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8.0 45.3L562.7 256l-89.4 89.4c-12.5 12.5-12.5 32.8.0 45.3s32.8 12.5 45.3.0l112-112c12.5-12.5 12.5-32.8.0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3.0zm-306.7.0c-12.5-12.5-32.8-12.5-45.3.0l-112 112c-12.5 12.5-12.5 32.8.0 45.3l112 112c12.5 12.5 32.8 12.5 45.3.0s12.5-32.8.0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8.0-45.3z"/></svg></span>
</span><span title=Projects class="text-2xl font-bold tracking-tight">Projects</span></a></div><div class=px-2><a href=/about/ aria-label=About class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span class="flex items-center justify-center h-8 w-8 text-2xl"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M266.3 48.3 232.5 73.6c-5.4 4-8.5 10.4-8.5 17.1v9.1c0 6.8 5.5 12.3 12.3 12.3 2.4.0 4.8-.7 6.8-2.1l41.8-27.9c2-1.3 4.4-2.1 6.8-2.1h1c6.2.0 11.3 5.1 11.3 11.3.0 3-1.2 5.9-3.3 8l-19.9 19.9c-5.8 5.8-12.9 10.2-20.7 12.8l-26.5 8.8c-5.8 1.9-9.6 7.3-9.6 13.4.0 3.7-1.5 7.3-4.1 10L202 182.1c-6.4 6.4-9.9 15-9.9 24v4.3c0 16.4 13.6 29.7 29.9 29.7 11 0 21.2-6.2 26.1-16l4-8.1c2.4-4.8 7.4-7.9 12.8-7.9 4.5.0 8.7 2.1 11.4 5.7l16.3 21.7c2.1 2.9 5.5 4.5 9.1 4.5 8.4.0 13.9-8.9 10.1-16.4l-1.1-2.3c-3.5-7 0-15.5 7.5-18l21.2-7.1c7.6-2.5 12.7-9.6 12.7-17.6.0-10.3 8.3-18.6 18.6-18.6H4e2c8.8.0 16 7.2 16 16s-7.2 16-16 16H379.3c-7.2.0-14.2 2.9-19.3 8l-4.7 4.7c-2.1 2.1-3.3 5-3.3 8 0 6.2 5.1 11.3 11.3 11.3h11.3c6 0 11.8 2.4 16 6.6l6.5 6.5c1.8 1.8 2.8 4.3 2.8 6.8s-1 5-2.8 6.8l-7.5 7.5C386 262 384 266.9 384 272s2 10 5.7 13.7L408 304c10.2 10.2 24.1 16 38.6 16H454c6.5-20.2 10-41.7 10-64 0-111.4-87.6-202.4-197.7-207.7zm172 307.9c-3.7-2.6-8.2-4.1-13-4.1-6 0-11.8-2.4-16-6.6L396 332c-7.7-7.7-18-12-28.9-12-9.7.0-19.2-3.5-26.6-9.8L314 287.4c-11.6-9.9-26.4-15.4-41.6-15.4h-21c-12.6.0-25 3.7-35.5 10.7L188.5 301c-17.8 11.9-28.5 31.9-28.5 53.3v3.2c0 17 6.7 33.3 18.7 45.3l16 16c8.5 8.5 20 13.3 32 13.3H248c13.3.0 24 10.7 24 24 0 2.5.4 5 1.1 7.3 71.3-5.8 132.5-47.6 165.2-107.2zM0 256a256 256 0 11512 0A256 256 0 110 256zM187.3 100.7c-6.2-6.2-16.4-6.2-22.6.0l-32 32c-6.2 6.2-6.2 16.4.0 22.6s16.4 6.2 22.6.0l32-32c6.2-6.2 6.2-16.4.0-22.6z"/></svg></span>
</span><span title=About class="text-2xl font-bold tracking-tight">About</span></a></div><div class=px-2><a href=/links/ aria-label=Links class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span class="flex items-center justify-center h-8 w-8 text-2xl"><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M172.5 131.1c55.6-55.59 148-55.59 203.6.0 50 50 57.4 129.7 16.3 187.2L391.3 319.9C381 334.2 361 337.6 346.7 327.3c-14.4-10.3-17.8-30.3-7.5-44.6L340.3 281.1C363.2 249 359.6 205.1 331.7 177.2c-31.4-31.4-82.5-31.4-114 0L105.5 289.5c-31.51 30.6-31.51 82.5.0 114C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4 265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2c-58.4 41.1-136.3 34.5-186.29-15.4-56.469-56.5-56.469-148.1.0-204.5L172.5 131.1zM467.5 380c-56.5 56.5-148 56.5-204.5.0-50-50-56.5-128.8-15.4-186.3L248.7 192.1C258.1 177.8 278.1 174.4 293.3 184.7 307.7 194.1 311.1 214.1 300.8 229.3L299.7 230.9C276.8 262.1 280.4 306.9 308.3 334.8c31.4 31.4 82.5 31.4 114 0L534.5 222.5c31.5-31.5 31.5-83.4.0-114C506.7 80.63 462.7 76.99 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58 374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.731 529.8 13.25 579.8 63.24c56.5 56.46 56.5 148.06.0 204.46L467.5 380z"/></svg>
</span></span><span title=Links class="text-2xl font-bold tracking-tight">Links</span></a></div></nav></div></div></div></div></div><script>(function(){var t,n,e=document.querySelector(".main-menu");if(!e)return;t=window.location.pathname,n=e.querySelectorAll('a[href="'+t+'"]'),n.forEach(function(e){var t=e.querySelectorAll("span");t.forEach(function(e){e.classList.add("active")})})})()</script></div></div><script type=text/javascript src=/js/background-blur.min.605b3b942818f0ab5a717ae446135ec46b8ee5a2ad12ae56fb90dc2a76ce30c388f9fec8bcc18db15bd47e3fa8a09d779fa12aa9c184cf614a315bc72c6c163d.js integrity="sha512-YFs7lCgY8KtacXrkRhNexGuO5aKtEq5W+5DcKnbOMMOI+f7IvMGNsVvUfj+ooJ13n6EqqcGEz2FKMVvHLGwWPQ==" data-blur-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><figure><img src=/posts/2020/automating-cloud-ipam/featured_hu_204130b3a771ebeb.png alt="AnsibleFest 2020 - Automating IPAM In Cloud" loading=eager decoding=async fetchpriority=high class="w-full rounded-lg single_hero_round nozoom"></figure><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>William Collins</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/>Posts</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/2020/automating-cloud-ipam/>AnsibleFest 2020 - Automating IPAM In Cloud</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">AnsibleFest 2020 - Automating IPAM In Cloud</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2020-10-13T07:16:08-04:00>13 October 2020</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">10 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/categories/automation/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Automation
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/categories/cloud/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Cloud
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/categories/community/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Community
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/ansible/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Ansible
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/azure/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Azure
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/terraform/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Terraform</span></span></a></div></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full me-4" width=96 height=96 alt="William Collins" src=/img/profile_hu_c9cd1d5a6744e127.png data-zoom-src=/img/profile_hu_6f0148836ebfa37e.png><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">William Collins</div><div class="text-sm text-neutral-700 dark:text-neutral-400">Building at the intersection of cloud, automation, and AI. Host of <a href=https://packetpushers.net/podcast/the-cloud-gambit/ target=_blank rel=noreferrer>The Cloud Gambit</a> podcast.</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://linkedin.com/in/william-collins target=_blank aria-label=Linkedin title=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/wcollins target=_blank aria-label=Github title=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://x.com/MacroEngineered target=_blank aria-label=X-Twitter title=X-Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span></a>
<a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://youtube.com/@MacroEngineered target=_blank aria-label=Youtube title=Youtube rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://wcollins.io/index.xml target=_blank aria-label=Rss title=Rss rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8.0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7.0 64zM128 416c0 35.3-28.7 64-64 64S0 451.3.0 416s28.7-64 64-64 64 28.7 64 64zM32 160c159.1.0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7.0-32-14.3-32-32s14.3-32 32-32z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ms-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain bf-scrollbar rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#what-is-ipam>What is IPAM?</a></li><li><a href=#the-problem>The Problem</a><ul><li><a href=#boundaries-are-blurred>Boundaries Are Blurred</a></li><li><a href=#inconsistency-in-data-domains>Inconsistency In Data Domains</a></li></ul></li><li><a href=#what-is-our-desired-outcome>What Is Our Desired Outcome?</a></li><li><a href=#why-automate-here>Why Automate Here?</a><ul><li><a href=#why-ansible-and-netbox>Why Ansible and Netbox?</a></li><li><a href=#prerequisites>Prerequisites</a></li></ul></li><li><a href=#what-are-we-automating>What Are We Automating?</a><ul><li><a href=#the-technology>The Technology</a></li><li><a href=#digging-down-into-the-environments>Digging Down Into The Environments</a></li></ul></li><li><a href=#design-drives-automation>Design Drives Automation</a><ul><li><a href=#standard-workflows>Standard Workflows</a></li><li><a href=#a-scalable-tagging-system>A Scalable Tagging System</a></li><li><a href=#touchpoints>Touchpoints</a></li></ul></li><li><a href=#breaking-down-the-logic>Breaking Down The Logic</a><ul><li><a href=#project-structure>Project Structure</a></li><li><a href=#ansible-collections>Ansible Collections</a></li><li><a href=#high-level-plays>High-Level Plays</a></li><li><a href=#functional-roles>Functional Roles</a></li><li><a href=#purpose-built-tasks>Purpose Built Tasks</a></li><li><a href=#the-physical-network>The Physical Network</a></li></ul></li><li><a href=#putting-it-all-together>Putting It All Together</a><ul><li><a href=#job-templates>Job Templates</a></li><li><a href=#workflow-templates>Workflow Templates</a></li><li><a href=#workflow-visualizer>Workflow Visualizer</a></li><li><a href=#using-surveys>Using Surveys</a></li><li><a href=#workflows-in-action>Workflows In Action</a></li><li><a href=#a-little-manual-validation>A Little Manual Validation</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#what-is-ipam>What is IPAM?</a></li><li><a href=#the-problem>The Problem</a><ul><li><a href=#boundaries-are-blurred>Boundaries Are Blurred</a></li><li><a href=#inconsistency-in-data-domains>Inconsistency In Data Domains</a></li></ul></li><li><a href=#what-is-our-desired-outcome>What Is Our Desired Outcome?</a></li><li><a href=#why-automate-here>Why Automate Here?</a><ul><li><a href=#why-ansible-and-netbox>Why Ansible and Netbox?</a></li><li><a href=#prerequisites>Prerequisites</a></li></ul></li><li><a href=#what-are-we-automating>What Are We Automating?</a><ul><li><a href=#the-technology>The Technology</a></li><li><a href=#digging-down-into-the-environments>Digging Down Into The Environments</a></li></ul></li><li><a href=#design-drives-automation>Design Drives Automation</a><ul><li><a href=#standard-workflows>Standard Workflows</a></li><li><a href=#a-scalable-tagging-system>A Scalable Tagging System</a></li><li><a href=#touchpoints>Touchpoints</a></li></ul></li><li><a href=#breaking-down-the-logic>Breaking Down The Logic</a><ul><li><a href=#project-structure>Project Structure</a></li><li><a href=#ansible-collections>Ansible Collections</a></li><li><a href=#high-level-plays>High-Level Plays</a></li><li><a href=#functional-roles>Functional Roles</a></li><li><a href=#purpose-built-tasks>Purpose Built Tasks</a></li><li><a href=#the-physical-network>The Physical Network</a></li></ul></li><li><a href=#putting-it-all-together>Putting It All Together</a><ul><li><a href=#job-templates>Job Templates</a></li><li><a href=#workflow-templates>Workflow Templates</a></li><li><a href=#workflow-visualizer>Workflow Visualizer</a></li><li><a href=#using-surveys>Using Surveys</a></li><li><a href=#workflows-in-action>Workflows In Action</a></li><li><a href=#a-little-manual-validation>A Little Manual Validation</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details><script>(function(){"use strict";const s=.33,o="#TableOfContents",i=".anchor",a='a[href^="#"]',r="li ul",c="active";let t=!1;function l(e,n){const o=window.scrollY+window.innerHeight*n,i=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],s=new Set(i.map(e=>e.getAttribute("href").substring(1)));if(t)for(let t=0;t<e.length;t++){const n=e[t];if(!s.has(n.id))continue;const o=n.getBoundingClientRect().top+window.scrollY;if(Math.abs(window.scrollY-o)<100)return n.id}for(let t=e.length-1;t>=0;t--){const n=e[t].getBoundingClientRect().top+window.scrollY;if(n<=o&&s.has(e[t].id))return e[t].id}return e.find(e=>s.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=l(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(c,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function n(){const n=document.querySelector(o);if(!n)return;const l=!1,u=[...document.querySelectorAll(i)],d=[...n.querySelectorAll(a)];l&&n.querySelectorAll(r).forEach(e=>e.style.display="none"),d.forEach(e=>{e.addEventListener("click",()=>{t=!0})});const c={toc:n,anchors:u,links:d,scrollOffset:s,collapseInactive:l};window.addEventListener("scroll",()=>e(c),{passive:!0}),window.addEventListener("hashchange",()=>e(c),{passive:!0}),e(c)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="AnsibleFest - 2020" src=/posts/2020/automating-cloud-ipam/ansible-fest.png width=2138 height=533><figcaption>AnsibleFest</figcaption></figure><p><a href=https://www.ansible.com/ansiblefest target=_blank rel=noreferrer>AnsibleFest 2020</a>, like most conferences this year, took place completely virtual. I presented on <em>Automating IPAM In Cloud: Ansible + Netbox</em>. You can find the slides along with the demonstration code in <a href=https://github.com/wcollins/ansible-cloud-ipam target=_blank rel=noreferrer>this git repo.</a> In this post, I&rsquo;m going to expand a little further on the content I presented.</p><h2 class="relative group">What is IPAM?<div id=what-is-ipam class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-ipam aria-label=Anchor>#</a></span></h2><p><em>IP Address Management (IPAM)</em> is the critical component that organizes your IP addresses and networks in one place. Responsible management of IP addressing drives efficient, repeatable, and reliable network automation. It is also a dependency for many other types of automation. Think of all the things that require IP addresses to communicate?</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="What is IPAM?" src=/posts/2020/automating-cloud-ipam/what-is-ipam.png width=2938 height=1127><figcaption>IPAM</figcaption></figure><h2 class="relative group">The Problem<div id=the-problem class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#the-problem aria-label=Anchor>#</a></span></h2><p>If you are <em>hybrid multi-cloud</em>, it probably means you share the same <a href=https://en.wikipedia.org/wiki/Private_network target=_blank rel=noreferrer>RFC1918</a> space across clouds and traditional networking. If this is the case, it means you probably want to keep track of allocation across <em>VNets</em>, <em>Subnets</em>, and <em>VMs</em>.</p><h3 class="relative group">Boundaries Are Blurred<div id=boundaries-are-blurred class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#boundaries-are-blurred aria-label=Anchor>#</a></span></h3><ul><li>As Hybrid Multi-Cloud becomes a reality, private IP space becomes shared across cloud(s) and on-premises</li><li>Developers leverage <strong>CI/CD</strong> as they deploy, maintain, and migrate applications in the cloud; network can&rsquo;t keep up</li><li>Some developers do not have a good understanding of how IP addressing works and how to consume it responsibly</li></ul><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="The Problem" src=/posts/2020/automating-cloud-ipam/the-problem.png width=2243 height=1208><figcaption>Problem</figcaption></figure><h3 class="relative group">Inconsistency In Data Domains<div id=inconsistency-in-data-domains class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#inconsistency-in-data-domains aria-label=Anchor>#</a></span></h3><ul><li>Data required for efficient automation is often dispersed across many tools and platforms</li><li>Frequently, overlap can exist between these tools and platforms for a given data domain</li><li>Tools and platforms may be owned and managed by different teams with different directions</li><li>Good automation is dependent on data accuracy, consistency, and ability to be consumed</li></ul><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Data Domains" src=/posts/2020/automating-cloud-ipam/data-domains.png width=2008 height=1498><figcaption>Data Domains</figcaption></figure><h2 class="relative group">What Is Our Desired Outcome?<div id=what-is-our-desired-outcome class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-our-desired-outcome aria-label=Anchor>#</a></span></h2><p>Aside from the idea that we want to automate IP address management, the main focus is <strong>user experience</strong>. This encompasses the overall experience for those designing for the future, supporting current, and consuming cloud networking services. The following considerations are critical:</p><ul><li>Minimal human intervention</li><li>Repeatable with other cloud providers</li><li>Compatible across traditional + cloud networking</li><li>End-to-end network automation</li></ul><h2 class="relative group">Why Automate Here?<div id=why-automate-here class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#why-automate-here aria-label=Anchor>#</a></span></h2><p>If <a href=https://www.tesla.com/ target=_blank rel=noreferrer><em>Tesla</em></a> can make self-driving cars and my coffee maker turns itself on in the morning, we can automate <em>IPAM</em> across the <em>hybrid multi-cloud</em> network, right? Also, the cloud demands agility. If you want agility, you need design patterns to build something repeatable against. If you manage IPAM in the cloud with any Microsoft Office tool, you are doing it wrong.</p><h3 class="relative group">Why Ansible and Netbox?<div id=why-ansible-and-netbox class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#why-ansible-and-netbox aria-label=Anchor>#</a></span></h3><p>Leveraging something like <a href=https://ansible.com target=_blank rel=noreferrer>Ansible</a> begins to make sense when the goal is automation at scale for networking across multiple vendors and environments. <a href=https://netbox.readthedocs.io/en/stable target=_blank rel=noreferrer>Netbox</a> can serve as a Source of Truth intended to represent the <em>desired</em> state of a network versus its <em>operational</em> state. The API is very flexible, and the functionality can drive many automation use cases well beyond IPAM.</p><h3 class="relative group">Prerequisites<div id=prerequisites class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#prerequisites aria-label=Anchor>#</a></span></h3><p>This post will not detail how to deploy Ansible or Netbox as there is plenty of examples out there already. There is excellent documentation for setting up both of these platforms via <a href=https://docker.com target=_blank rel=noreferrer>Docker</a>. Instructions for setting up <em>Ansible AWX</em> can be found <a href=https://github.com/ansible/awx target=_blank rel=noreferrer>here</a> and <em>Netbox</em> <a href=https://github.com/netbox-community/netbox-docker target=_blank rel=noreferrer>here.</a></p><p>To authenticate to an Azure subscription, you will need to create a <a href=https://docs.microsoft.com/en-us/azure/active-directory/develop/app-objects-and-service-principals target=_blank rel=noreferrer>Service Principal</a>. Once a Service Principal is created, you will need to assign a role so that you can access the resources in that subscription. Detailed instructions for completing these steps can be found <a href=https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal target=_blank rel=noreferrer>here.</a></p><h2 class="relative group">What Are We Automating?<div id=what-are-we-automating class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-are-we-automating aria-label=Anchor>#</a></span></h2><p>Let&rsquo;s examine the cloud environment so we can begin formulating our approach for how we want to automate.</p><h3 class="relative group">The Technology<div id=the-technology class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#the-technology aria-label=Anchor>#</a></span></h3><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="The Tech" src=/posts/2020/automating-cloud-ipam/the-tech.png width=2498 height=1029><figcaption>The Tech</figcaption></figure><h3 class="relative group">Digging Down Into The Environments<div id=digging-down-into-the-environments class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#digging-down-into-the-environments aria-label=Anchor>#</a></span></h3><p>In the cloud, you generally have a hierarchy in which logical components exist, which may contain additional logical components. With Azure, for instance, management groups include subscriptions. Subscriptions hold Resource Groups, which include VNets. A VNet may be a shared resource across many apps and services in scope across many teams.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Cloud Environment" src=/posts/2020/automating-cloud-ipam/cloud-azure-env.png width=5751 height=2153><figcaption>Cloud Environment</figcaption></figure><p>Colocation Data Centers like <a href=https://www.equinix.com/ target=_blank rel=noreferrer>Equinix</a> or <a href=https://www.megaport.com/ target=_blank rel=noreferrer>Megaport</a> are being used more frequently as demand for cloud services increase. We will need to make some changes to a few physical <a href=https://www.cisco.com/c/en/us/products/routers/asr-1002-hx-router/index.html target=_blank rel=noreferrer>Cisco ASRs</a>, so packets can route.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Cloud Environment - CoLo" src=/posts/2020/automating-cloud-ipam/cloud-env-colo.png width=2976 height=902><figcaption>Cloud</figcaption></figure><h2 class="relative group">Design Drives Automation<div id=design-drives-automation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#design-drives-automation aria-label=Anchor>#</a></span></h2><p>Thinking through a given design is a crucial element for how you approach the automation. If our goal is <em>end-to-end</em> network automation at scale, that means we must automate across multiple vendors and environments.</p><h3 class="relative group">Standard Workflows<div id=standard-workflows class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#standard-workflows aria-label=Anchor>#</a></span></h3><p>To automate both the foundational (shared) and service-oriented (app-specific) components, leveraging two distinct workflows makes sense.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Standard Workflows" src=/posts/2020/automating-cloud-ipam/standard-workflows.png width=2451 height=1296><figcaption>Standard Workflows</figcaption></figure><h3 class="relative group">A Scalable Tagging System<div id=a-scalable-tagging-system class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#a-scalable-tagging-system aria-label=Anchor>#</a></span></h3><p>If you want to do cloud right, cost governance should be in your considerations. This means a well-designed and consistently applied tagging convention, which compliments lifecycle management, automation, and visibility in reporting. In treating our pets like cattle, we need a <em>source of truth</em> with standardized identification across all networking components.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Resource Tagging" src=/posts/2020/automating-cloud-ipam/resource-tagging.png width=2816 height=2059><figcaption>Resource Tagging</figcaption></figure><h3 class="relative group">Touchpoints<div id=touchpoints class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#touchpoints aria-label=Anchor>#</a></span></h3><p>Between both of our workflows, there are numerous touchpoints:</p><ul><li><a href=https://docs.ansible.com/ansible/latest/plugins/connection/network_cli.html target=_blank rel=noreferrer>network_cli</a> for traditional networking</li><li><a href=https://docs.ansible.com/ansible/latest/modules/list_of_cloud_modules.html#azure target=_blank rel=noreferrer>Ansible Cloud Modules</a> via <a href=https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/overview target=_blank rel=noreferrer>Azure Resource Manager</a></li><li><a href=https://galaxy.ansible.com/netbox/netbox target=_blank rel=noreferrer>Netbox Collection</a> leveraging the Netbox API</li></ul><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=Touchpoints src=/posts/2020/automating-cloud-ipam/touchpoints.png width=2843 height=1759><figcaption>Touchpoints</figcaption></figure><h2 class="relative group">Breaking Down The Logic<div id=breaking-down-the-logic class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#breaking-down-the-logic aria-label=Anchor>#</a></span></h2><p>A great benefit of using <a href=https://www.ansible.com/ target=_blank rel=noreferrer>Ansible</a> is flexibility. This can also cause significant confusion as there are many ways in which we can structure things. It is beneficial to understand the structure, logic flow, and inheritance.</p><h3 class="relative group">Project Structure<div id=project-structure class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#project-structure aria-label=Anchor>#</a></span></h3><p>Thinking through your project structure can make future work more manageable. The following guide - <a href=https://docs.ansible.com/ansible/latest/user_guide/playbooks_best_practices.html target=_blank rel=noreferrer>Best Practices - Content Organization</a> in Ansible&rsquo;s documentation is a good starting point. However, this is not a one size fits all scenario, and experimenting, reevaluating, and tweaking will probably be necessary. The following approach has served me well in the past.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Project Structure" src=/posts/2020/automating-cloud-ipam/project-structure.png width=2421 height=1489><figcaption>Project Structure</figcaption></figure><h3 class="relative group">Ansible Collections<div id=ansible-collections class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#ansible-collections aria-label=Anchor>#</a></span></h3><p><a href=https://www.ansible.com/products/content-collections target=_blank rel=noreferrer>Ansible Collections</a> are pretty slick. My only recommendation here is, manage your collections with a <em>requirements.yml</em> file. When it comes to testing new versions of a collection, all you need do is create a new git branch, set the new version in your <em>requirements.yml</em> file, and point Tower to this branch. Ansible has documented collections usage pretty thoroughly <a href=https://docs.ansible.com/ansible/latest/user_guide/collections_using.html target=_blank rel=noreferrer>here.</a></p><p><a href=https://github.com/wcollins/ansible-cloud-ipam/blob/master/collections/requirements.yml target=_blank rel=noreferrer><strong>ansible-cloud-ipam/collections/requirements.yml</strong></a></p><div class=highlight-wrapper><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>collections</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>netbox.netbox</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>1.0.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>source</span><span class=p>:</span><span class=w> </span><span class=l>https://galaxy.ansible.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=nn>...</span></span></span></code></pre></td></tr></table></div></div></div><blockquote><p>I would stress never pulling down collections from Galaxy and committing them directly into the source control repository for your project. Friends do not let friends engage in this type of behavior!</p></blockquote><h3 class="relative group">High-Level Plays<div id=high-level-plays class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#high-level-plays aria-label=Anchor>#</a></span></h3><p>The playbooks sitting in our root project folder are pretty simple. They are primarily used as the <em>entry</em> point for Ansible and execute based on a specific condition.</p><p><a href=https://github.com/wcollins/ansible-cloud-ipam/blob/master/play.azure_snet_add.yml target=_blank rel=noreferrer><strong>ansible-cloud-ipam/play.azure_snet_add.yml</strong></a></p><div class=highlight-wrapper><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl>- <span class=nt>hosts</span><span class=p>:</span><span class=w> </span><span class=l>all</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>connection</span><span class=p>:</span><span class=w> </span><span class=l>local</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hosts</span><span class=p>:</span><span class=w> </span><span class=l>localhost</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>gather_facts</span><span class=p>:</span><span class=w> </span><span class=kc>False</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>vars</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>play_action</span><span class=p>:</span><span class=w> </span><span class=l>netbox_reserve_prefix_snet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>roles</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>netbox</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=nn>...</span></span></span></code></pre></td></tr></table></div></div></div><h3 class="relative group">Functional Roles<div id=functional-roles class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#functional-roles aria-label=Anchor>#</a></span></h3><p>Roles for this demo are organized by either a given platform or OS type. Each role&rsquo;s main file will include specific <em>tasks</em> to use based on the condition defined in the root level play.</p><p><a href=https://github.com/wcollins/ansible-cloud-ipam/blob/master/roles/netbox/tasks/main.yml target=_blank rel=noreferrer><strong>ansible-cloud-ipam/roles/netbox/tasks/main.yml</strong></a></p><div class=highlight-wrapper><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl>- <span class=nt>include_tasks</span><span class=p>:</span><span class=w> </span><span class=l>task.netbox_reserve_prefix_vnet.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>when</span><span class=p>:</span><span class=w> </span><span class=l>play_action == &#39;netbox_reserve_prefix_vnet&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl>- <span class=nt>include_tasks</span><span class=p>:</span><span class=w> </span><span class=l>task.netbox_reserve_prefix_snet.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>when</span><span class=p>:</span><span class=w> </span><span class=l>play_action == &#39;netbox_reserve_prefix_snet&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=nn>...</span></span></span></code></pre></td></tr></table></div></div></div><h3 class="relative group">Purpose Built Tasks<div id=purpose-built-tasks class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#purpose-built-tasks aria-label=Anchor>#</a></span></h3><p>The actual logic is handled inside a given role&rsquo;s tasks. Each task is purpose-built and does a very intentional thing. Also, the idea is to keep things DRY <em>(Don&rsquo;t repeat yourself)</em> so that we can easily reuse things. This means we don&rsquo;t want to set values here statically. The smaller a thing is, the less it does. If something does less, it makes it easier to repeat.</p><p><a href=https://github.com/wcollins/ansible-cloud-ipam/blob/master/roles/netbox/tasks/task.netbox_reserve_prefix_snet.yml target=_blank rel=noreferrer><strong>ansible-cloud-ipam/roles/netbox/tasks/task.netbox_reserve_prefix_snet.yml</strong></a></p><div class=highlight-wrapper><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Add next prefix in Netbox</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>netbox.netbox.netbox_prefix</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>netbox_url</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;{{ netbox_url }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>netbox_token</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;{{ netbox_token }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>data</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Define criteria for prefix</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>parent</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;{{ prefix_parent }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>prefix_length</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;{{ prefix_length }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Define criteria for site</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>tenant</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;{{ tenant_name }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>site</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;{{ azure_location }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Metadata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>prefix_role</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;{{ prefix_role }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;{{ prefix_desc }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Tags</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>tags</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=s2>&#34;{{ app_name }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=s2>&#34;{{ app_tier }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=s2>&#34;{{ app_env }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=s2>&#34;{{ billing_id }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=s2>&#34;{{ business_unit }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=s2>&#34;{{ support_group }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># State</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>state</span><span class=p>:</span><span class=w> </span><span class=l>present</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>first_available</span><span class=p>:</span><span class=w> </span><span class=kc>yes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Register output</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>register</span><span class=p>:</span><span class=w> </span><span class=l>first_available</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Set stat for prefix string</span><span class=w>
</span></span></span><span class=line><span class=cl>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Set stats</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>set_stats</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>data</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>net_prefix</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;{{ first_available.prefix.prefix }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=nn>...</span></span></span></code></pre></td></tr></table></div></div></div><h3 class="relative group">The Physical Network<div id=the-physical-network class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#the-physical-network aria-label=Anchor>#</a></span></h3><p>Out of the three platforms we have interacted with here, the <a href=https://www.cisco.com/c/en/us/products/routers/asr-1002-hx-router/index.html target=_blank rel=noreferrer>Cisco ASR</a> is the only one that isn&rsquo;t <em>API</em> driven. For automating this beauty, I&rsquo;ll be using the <a href=https://docs.ansible.com/ansible/latest/modules/ios_config_module.html target=_blank rel=noreferrer>ios_config</a> module for configuration.</p><p>There are more modern ways to do this today, but this is probably the reality for most in practice. This is a straightforward use case, so this type of execution serves its purpose for a demo&rsquo;s scope. Each time the <em>Service Workflow</em> is run, the subnet it reserves will be appended to a <em>prefix-list</em> living on the <em>ASR</em>.</p><p>In a <em>real world</em> cloud scenario, this <em>prefix-list</em> could be used to identify and filter traffic. It could then be used inside a <em>route-map</em> to enable and enforce policy criteria beyond the <em>routing table</em>. When doing BGP to the cloud, this can be important as you may want to enforce specific policies on specific neighbors to particular clouds.</p><p><a href=https://github.com/wcollins/ansible-cloud-ipam/blob/master/roles/cisco-ios/tasks/task.ios_prefix_list_append.yml target=_blank rel=noreferrer><strong>ansible-cloud-ipam/roles/cisco-ios/tasks/task.ios_prefix_list_append.yml</strong></a></p><div class=highlight-wrapper><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c># Block - Append prefix-list on IOS</span><span class=w>
</span></span></span><span class=line><span class=cl>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Append prefix-list on IOS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>block</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Create temp staging directory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Stage config directory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>file</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;staging/{{ inventory_hostname }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>state</span><span class=p>:</span><span class=w> </span><span class=l>directory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>mode</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;0777&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=c># Stage configuration for IOS prefix-list</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Stage configuration for IOS prefix-list</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>src</span><span class=p>:</span><span class=w> </span><span class=l>prefix_list_append.j2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>dest</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;staging/{{ inventory_hostname }}/prefix_list_append.cfg&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># Push configuration to IOS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Push configuration to IOS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ios_config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>src</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;staging/{{ inventory_hostname }}/prefix_list_append.cfg&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=c># Clean up temp staging directory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Clean staging directory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>file</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;staging/{{ inventory_hostname }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>state</span><span class=p>:</span><span class=w> </span><span class=l>absent</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=nn>...</span></span></span></code></pre></td></tr></table></div></div></div><h2 class="relative group">Putting It All Together<div id=putting-it-all-together class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#putting-it-all-together aria-label=Anchor>#</a></span></h2><p>Ansible Tower offers two flavors of templates. <a href=https://docs.ansible.com/ansible-tower/latest/html/userguide/job_templates.html target=_blank rel=noreferrer>Job Templates</a> are used to execute a single task many times, while <a href=https://docs.ansible.com/ansible-tower/latest/html/userguide/workflow_templates.html target=_blank rel=noreferrer>Workflow Templates</a> stitch together multiple <em>Job Templates</em>.</p><p>The value here aims at getting the same outcome that your typical <em>Build/Release</em> pipelines would offer for <em>Infrastructure as Code</em>. When thinking of <em>infrastructure as Code</em>, I generally think <em>immutability</em> and cloud <em>exclusivity</em>.</p><p>In my opinion, this approach lends itself more to remaining flexible and accommodating for a multitude of disparate and traditional infrastructure while also providing the ability to integrate with new technologies.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=Templates src=/posts/2020/automating-cloud-ipam/putting-it-together.png width=3167 height=1369><figcaption>Templates</figcaption></figure><h3 class="relative group">Job Templates<div id=job-templates class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#job-templates aria-label=Anchor>#</a></span></h3><p>In the spirit of building for repeatability, I created <em>Job Templates</em> for each unique task. This allows me to reuse them over time in new <em>Workflow Templates</em> as new use cases present themselves.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Create Job Template" src=/posts/2020/automating-cloud-ipam/create-job-template.gif width=800 height=411><figcaption>Job Template</figcaption></figure><h3 class="relative group">Workflow Templates<div id=workflow-templates class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#workflow-templates aria-label=Anchor>#</a></span></h3><p>I then assembled my two <em>Workflow Templates</em> outlined above. The <em>Base Workflow</em> in practice would be run far less frequently than the <em>Service Workflow</em>.</p><h3 class="relative group">Workflow Visualizer<div id=workflow-visualizer class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#workflow-visualizer aria-label=Anchor>#</a></span></h3><p>Stitching your workflow together is pretty simple with Tower&rsquo;s <em>workflow visualizer</em>. Once you create a blanket workflow, you can add and arrange jobs.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Workflow Visualizer" src=/posts/2020/automating-cloud-ipam/workflow-visualizer.gif width=800 height=415><figcaption>Workflow Visualizer</figcaption></figure><h3 class="relative group">Using Surveys<div id=using-surveys class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#using-surveys aria-label=Anchor>#</a></span></h3><p><a href=https://docs.ansible.com/ansible-tower/latest/html/userguide/job_templates.html#surveys target=_blank rel=noreferrer>Surveys</a> are a great way to populate variables at runtime interactively. Once a <em>source of truth</em> in a given data domain is populated, and the logic is more mature, this will probably be used less.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Using Surveys" src=/posts/2020/automating-cloud-ipam/using-surveys.gif width=800 height=342><figcaption>Surveys</figcaption></figure><h3 class="relative group">Workflows In Action<div id=workflows-in-action class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#workflows-in-action aria-label=Anchor>#</a></span></h3><p>Now that our workflow is populated with the right variables let&rsquo;s take it for a spin!</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Running Workflows" src=/posts/2020/automating-cloud-ipam/running-workflows.gif width=800 height=177><figcaption>Running Workflows</figcaption></figure><h3 class="relative group">A Little Manual Validation<div id=a-little-manual-validation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#a-little-manual-validation aria-label=Anchor>#</a></span></h3><p>Purely for the sake of delightful visuals, let&rsquo;s validate a few things.</p><p><strong>Netbox Prefix Reservation:</strong>
We can see here that the next available prefix was reserved, configuration criteria are correct, and our enforced tags are in place.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Netbox Validation" src=/posts/2020/automating-cloud-ipam/validate-netbox.gif width=800 height=467><figcaption>Netbox Validation</figcaption></figure><p><strong>Cisco ASR 1002-HX Configuration:</strong>
The prefix reserved above has now been added to the <em>cloud-allowed-prefixes</em> list on our router. If the list does not exist, the job will create it. From there, any new prefixes reserved will then be appended.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Cisco ASR 1002-HX Validation" src=/posts/2020/automating-cloud-ipam/validate-prefix.gif width=1000 height=214><figcaption>ASR Validation</figcaption></figure><h2 class="relative group">Conclusion<div id=conclusion class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#conclusion aria-label=Anchor>#</a></span></h2><p>Building a logical way for developers to consume <em>IPAM</em> at the speed of cloud is <strong><em>WINNING!</em></strong> Remember, go <strong>fast</strong>, but go <strong>responsibly!</strong></p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Go Fast!" src=/posts/2020/automating-cloud-ipam/go-fast.gif width=800 height=348><figcaption>Go Fast!</figcaption></figure></div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://wcollins.io/posts/2020/automating-cloud-ipam/&amp;title=AnsibleFest%202020%20-%20Automating%20IPAM%20In%20Cloud" title="Share on LinkedIn" aria-label="Share on LinkedIn"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://reddit.com/submit/?url=https://wcollins.io/posts/2020/automating-cloud-ipam/&amp;resubmit=true&amp;title=AnsibleFest%202020%20-%20Automating%20IPAM%20In%20Cloud" title="Submit to Reddit" aria-label="Submit to Reddit"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://wcollins.io/posts/2020/automating-cloud-ipam/&amp;subject=AnsibleFest%202020%20-%20Automating%20IPAM%20In%20Cloud" title="Send via email" aria-label="Send via email"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></a></section><h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2><section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3"><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/posts/2020/setup-awx-on-debian/featured_hu_9f3f60d8f2f4a5d9.png role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/2020/setup-awx-on-debian/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Setting Up Ansible (AWX) On Debian</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2020-05-28T12:29:55-04:00>28 May 2020</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">6 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/categories/automation/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Automation
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/ansible/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Ansible
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/docker/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Docker
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/linux/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Linux</span></span></a></div></div><div class="article-link__summary prose dark:prose-invert mt-1 line-clamp-5">Ansible Tower VS AWX # The best way to learn is by constructing your own knowledge, not passively absorbing information. A lot of great projects are open source these days, including The AWX Project. At zero cost, you can build your automation skill set, increasing your chances at landing that next big promotion.</div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/posts/2020/alkira-multicloud-networking/featured_hu_1ae575dd00094e52.png role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/2020/alkira-multicloud-networking/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Multi-Cloud Networking With Alkira</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2020-08-19T13:01:29-04:00>19 August 2020</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">15 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/categories/cloud/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Cloud
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/categories/networking/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Networking
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/alkira/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Alkira
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/aws/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Aws
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/azure/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Azure
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/gcp/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Gcp</span></span></a></div></div><div class="article-link__summary prose dark:prose-invert mt-1 line-clamp-5">Introduction # Multi-Cloud is making its rounds. Network and Security engineers face increasing challenges with managing complexity and risk as they work to react with more agility to enable business outcomes. At the start, enterprises didn&rsquo;t just decide they would be multi-cloud. They started with a single cloud, likely Amazon Web Services and tailored their strategy around that cloud&rsquo;s architecture and features.</div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/posts/2020/automate-blog-deployment/featured_hu_94e34f404d92ce20.png role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/2020/automate-blog-deployment/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Automating Blog Releases: Hugo + GitHub Actions</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2020-06-21T17:14:44-04:00>21 June 2020</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">6 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/categories/automation/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Automation
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/hugo/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Hugo
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/github-actions/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Github-Actions</span></span></a></div></div><div class="article-link__summary prose dark:prose-invert mt-1 line-clamp-5">A lot of the work I do professionally involves transforming traditional network culture, practices, and technology. Just as DevOps transformed application delivery, NetDevOps is here to make sure the network can keep up. This post will cover how I deploy this blog with Hugo to GitHub Pages using GitHub Actions to completely automate the workflow. This is very similar to how I approached modernizing network documentation for my current employer. Listen to Day Two Cloud Podcast as I talk through this transformation in more detail.</div></div><div class="px-6 pt-4 pb-2"></div></article></section></div></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/2020/alkira-multicloud-networking/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;Multi-Cloud Networking With Alkira
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2020-08-19T13:01:29-04:00>19 August 2020</time>
</span></span><span class="flex flex-col items-end"><a class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/2021/cloud-security-and-azure-private-link/><span class=leading-6>Cloud Security And Azure Private Link&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
</span></a><span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2021-01-11T18:55:25-05:00>11 January 2021</time></span></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex list-none flex-col sm:flex-row"><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/tags/ title=Tags>Tags</a></li><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/categories/ title=Categories>Categories</a></li><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/series/ title=Series>Series</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2026
William Collins</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://wcollins.io/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>
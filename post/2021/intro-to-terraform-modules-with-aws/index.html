<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>Intro To Terraform Modules With AWS - </title>
<meta name=renderer content="webkit">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1">
<meta http-equiv=cache-control content="no-transform">
<meta http-equiv=cache-control content="no-siteapp">
<meta name=theme-color content="#f8f5ec">
<meta name=msapplication-navbutton-color content="#f8f5ec">
<meta name=apple-mobile-web-app-capable content="yes">
<meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec">
<meta name=author content="William Collins"><meta name=description content="Effectively automating infrastructure is no longer a luxury but a staple in the enterprise move through future transformation. I wrote a blog recently about using Terraform with Packer together, and wanted to take this thought further with breaking down Terraform Modules and getting well connected with Terraform Cloud. I recently put together a simple module for building base infrastructure in AWS for the purpose of testing Alkira Network Cloud. Let&amp;rsquo;s dive in!">
<meta name=google-site-verification content="FSCEdJZD7nAoKk16ak20hRMKNBvXlnHAU0PBBDZy5DU">
<meta name=generator content="Hugo 0.87.0 with theme even">
<link rel=canonical href=http://wcollins.io/post/2021/intro-to-terraform-modules-with-aws/>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png>
<link rel=manifest href=/manifest.json>
<link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5>
<link href=/sass/main.min.8c3cbcb0324c2bb4875ceccba4007cbad4b4ac8377f33af9953c3e7684534a50.css rel=stylesheet>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous>
<meta property="og:title" content="Intro To Terraform Modules With AWS">
<meta property="og:description" content="Effectively automating infrastructure is no longer a luxury but a staple in the enterprise move through future transformation. I wrote a blog recently about using Terraform with Packer together, and wanted to take this thought further with breaking down Terraform Modules and getting well connected with Terraform Cloud. I recently put together a simple module for building base infrastructure in AWS for the purpose of testing Alkira Network Cloud. Let&rsquo;s dive in!">
<meta property="og:type" content="article">
<meta property="og:url" content="http://wcollins.io/post/2021/intro-to-terraform-modules-with-aws/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2021-06-23T08:46:40-04:00">
<meta property="article:modified_time" content="2021-06-23T08:46:40-04:00">
<meta itemprop=name content="Intro To Terraform Modules With AWS">
<meta itemprop=description content="Effectively automating infrastructure is no longer a luxury but a staple in the enterprise move through future transformation. I wrote a blog recently about using Terraform with Packer together, and wanted to take this thought further with breaking down Terraform Modules and getting well connected with Terraform Cloud. I recently put together a simple module for building base infrastructure in AWS for the purpose of testing Alkira Network Cloud. Let&rsquo;s dive in!"><meta itemprop=datePublished content="2021-06-23T08:46:40-04:00">
<meta itemprop=dateModified content="2021-06-23T08:46:40-04:00">
<meta itemprop=wordCount content="575">
<meta itemprop=keywords content="aws,iaas,immutability,linux,terraform,terraform cloud,terraform modules,ubuntu,"><meta name=twitter:card content="summary">
<meta name=twitter:title content="Intro To Terraform Modules With AWS">
<meta name=twitter:description content="Effectively automating infrastructure is no longer a luxury but a staple in the enterprise move through future transformation. I wrote a blog recently about using Terraform with Packer together, and wanted to take this thought further with breaking down Terraform Modules and getting well connected with Terraform Cloud. I recently put together a simple module for building base infrastructure in AWS for the purpose of testing Alkira Network Cloud. Let&rsquo;s dive in!"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]-->
</head>
<body>
<div id=mobile-navbar class=mobile-navbar>
<div class=mobile-header-logo>
<a href=/ class=logo></a>
</div>
<div class=mobile-navbar-icon>
<span></span>
<span></span>
<span></span>
</div>
</div>
<nav id=mobile-menu class="mobile-menu slideout-menu">
<ul class=mobile-menu-list>
<a href=/>
<li class=mobile-menu-item>Home</li>
</a><a href=/about/>
<li class=mobile-menu-item>About</li>
</a><a href=/post/>
<li class=mobile-menu-item>Archives</li>
</a><a href=/tags/>
<li class=mobile-menu-item>Tags</li>
</a><a href=/categories/>
<li class=mobile-menu-item>Categories</li>
</a>
</ul>
</nav>
<div class=container id=mobile-panel>
<header id=header class=header>
<div class=logo-wrapper>
<a href=/ class=logo></a>
</div>
<nav class=site-navbar>
<ul id=menu class=menu>
<li class=menu-item>
<a class=menu-item-link href=/>Home</a>
</li><li class=menu-item>
<a class=menu-item-link href=/about/>About</a>
</li><li class=menu-item>
<a class=menu-item-link href=/post/>Archives</a>
</li><li class=menu-item>
<a class=menu-item-link href=/tags/>Tags</a>
</li><li class=menu-item>
<a class=menu-item-link href=/categories/>Categories</a>
</li>
</ul>
</nav>
</header>
<main id=main class=main>
<div class=content-wrapper>
<div id=content class=content>
<article class=post>
<header class=post-header>
<h1 class=post-title>Intro To Terraform Modules With AWS</h1>
<div class=post-meta>
<span class=post-time> June 23, 2021 </span>
<div class=post-category>
<a href=/categories/automation/> automation </a>
<a href=/categories/cloud/> cloud </a>
<a href=/categories/tools/> tools </a>
</div>
<span class=more-meta> 575 words </span>
<span class=more-meta> 3 mins read </span>
</div>
</header>
<div class=post-toc id=post-toc>
<h2 class=post-toc-title>Contents</h2>
<div class=post-toc-content>
<nav id=TableOfContents>
<ul>
<li>
<ul>
<li><a href=#what-is-a-terraform-module>What Is A Terraform Module?</a></li>
<li><a href=#creating-a-custom-module>Creating A Custom Module</a>
<ul>
<li><a href=#version-control>Version Control</a></li>
<li><a href=#creating-a-release>Creating A Release</a></li>
<li><a href=#publishing-a-module>Publishing A Module</a></li>
</ul>
</li>
<li><a href=#terraform-cloud>Terraform Cloud</a>
<ul>
<li><a href=#create-a-workspace>Create A Workspace</a></li>
<li><a href=#apply-infrastructure>Apply Infrastructure</a></li>
<li><a href=#destroy-infrastructure>Destroy Infrastructure</a></li>
</ul>
</li>
<li><a href=#conclusion>Conclusion</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
<div class=post-content>
<p>Effectively automating infrastructure is no longer a luxury but a staple in the enterprise move through future transformation. I wrote a blog recently about <a href=https://wcollins.io/post/2021/cloud-grade-automation-with-packer-and-terraform/>using Terraform with Packer together</a>, and wanted to take this thought further with breaking down <strong>Terraform Modules</strong> and getting well connected with <strong>Terraform Cloud</strong>. I recently put together a simple module for building base infrastructure in <a href=https://aws.amazon.com/>AWS</a> for the purpose of testing <a href=https://www.alkira.com/>Alkira Network Cloud</a>. Let&rsquo;s dive in!</p>
<p><img src=/images/2021/intro-to-terraform-modules-with-aws/intro.png alt=Intro></p>
<h2 id=what-is-a-terraform-module>What Is A Terraform Module?</h2>
<p>If striving to build repeatable blocks of infrastructure that get provisioned consistently is the goal, then getting acquainted with <a href=https://www.terraform.io/docs/language/modules/index.html>Terraform Modules</a> can help you get there. Deploying cloud infrastructure means deploying resources that depend on each other, are generally deployed together, and share the same lifecycle. This is what Terraform modules do - <em>enable the packaging and management of common resources together, extending reuse and environmental consistency</em>.</p>
<p>Modules are managed in a <a href=https://github.com/>version control system like Github</a> and published to <a href=https://registry.terraform.io/browse/modules>Terraform Registry</a>. Terraform&rsquo;s Enterprise and Cloud variant have a <strong>private</strong> registry, making it an ideal vehicle for building, sharing, and managing internal modules for an organization. Furthermore, once a given module is published, it can be used in tandem with other modules to build purpose-based <a href=https://www.terraform.io/docs/cloud/workspaces/index.html>workspaces</a>. For this example, I&rsquo;m going to use the <strong>public</strong> registry.</p>
<h2 id=creating-a-custom-module>Creating A Custom Module</h2>
<p>For my testing, I needed the flexibility to create a new <a href=https://aws.amazon.com/vpc/>AWS VPC</a> in one or more regions, provide a dynamic list of subnets to be provisioned, and also create a lightweight <a href=https://aws.amazon.com/ec2/instance-types/t2/>EC2 instance</a> per subnet. However, setting these environments up by hand takes time, and tearing down all the infrastructure manually takes even more time. Plus, I want to use this configuration in tandem with similar scenarios in other cloud providers while testing and demonstrating <a href=https://www.alkira.com/>Alkira</a>.</p>
<h3 id=version-control>Version Control</h3>
<p><a href=https://github.com/wcollins/terraform-aws-awsinfra>The following repository</a> was created to hold my work on Github. Module components include:</p>
<ul>
<li><a href=https://github.com/wcollins/terraform-aws-awsinfra/blob/main/main.tf><strong>main.tf</strong></a> - Primary logic which describes the infrastructure I want to build</li>
<li><a href=https://github.com/wcollins/terraform-aws-awsinfra/blob/main/variables.tf><strong>variables.tf</strong></a> - Required input variables which must be set in the module block</li>
<li><a href=https://github.com/wcollins/terraform-aws-awsinfra/blob/main/outputs.tf><strong>outputs.tf</strong></a> - Variables that can be exposed for other Terraform configurations to use; These act similar to <em>return values</em> in programming languages</li>
<li><a href=https://github.com/wcollins/terraform-aws-awsinfra/blob/main/versions.tf><strong>versions.tf</strong></a> - Acceptable versions of Terraform and the provider that work with my custom module</li>
</ul>
<h3 id=creating-a-release>Creating A Release</h3>
<p>Terraform <strong>public</strong> and <strong>private</strong> registry expects release tags that can be used to identify module versions:</p>
<p><img src=/images/2021/intro-to-terraform-modules-with-aws/release-tags.gif alt="Release Tags"></p>
<h3 id=publishing-a-module>Publishing A Module</h3>
<p>Publishing the new module couldn&rsquo;t be easier. When going through the setup, it will ask to connect your Github account to the registry. If uploading to the <strong>public</strong> registry, only access to your public repositories will be needed.</p>
<p><img src=/images/2021/intro-to-terraform-modules-with-aws/publish-module.gif alt="Publish Module"></p>
<h2 id=terraform-cloud>Terraform Cloud</h2>
<p><a href=https://www.terraform.io/cloud>Terraform Cloud</a> makes provisioning easy. I set up <a href=https://github.com/wcollins/aws-infra-east-npe>the following repository</a> to test out the new module. To run the new module, we need two files:</p>
<p><a href=https://github.com/wcollins/aws-infra-east-npe/blob/main/main.tf><strong>main.tf</strong></a>
<script type=application/javascript src=https://gist.github.com/wcollins/b663f9181607cfd5a83d46158e0446d1.js></script>
</p>
<p><a href=https://github.com/wcollins/aws-infra-east-npe/blob/main/variables.tf><strong>variables.tf</strong></a>
<script type=application/javascript src=https://gist.github.com/wcollins/bb44fa9aa07c861ee1f23203a4fe92d6.js></script>
</p>
<h3 id=create-a-workspace>Create A Workspace</h3>
<p>Before applying any infrastructure, we must create a new <a href=https://www.terraform.io/docs/cloud/workspaces/index.html>Workspace</a> in Terraform Cloud.</p>
<p><img src=/images/2021/intro-to-terraform-modules-with-aws/tf-cloud-workspace.gif alt="Terraform Cloud Workspace"></p>
<h3 id=apply-infrastructure>Apply Infrastructure</h3>
<p>After creating the Workspace and populating the appropriate variables, we can provision our desired infrastructure:</p>
<p><img src=/images/2021/intro-to-terraform-modules-with-aws/tf-cloud-apply.gif alt="Terraform Cloud Apply"></p>
<h3 id=destroy-infrastructure>Destroy Infrastructure</h3>
<p>Running cloud infrastructure that isn&rsquo;t being used is a great way to rack up unwanted costs. So when testing is completed, let&rsquo;s destroy our infrastructure.</p>
<p><img src=/images/2021/intro-to-terraform-modules-with-aws/tf-cloud-destroy.gif alt="Terraform Cloud Destroy"></p>
<h2 id=conclusion>Conclusion</h2>
<p>Delivering automation in the context of <strong>complete environments deployed intact</strong> heralds a whole new world of possibilities. <a href=https://www.terraform.io/docs/language/modules/develop/index.html>Terraform Modules</a> simplify the building blocks of <em>immutable infrastructure</em>, and <a href=https://www.terraform.io/cloud>Terraform Cloud</a> enhances the ability to deliver and iterate. Stay tuned for new content coming that showcases the power of Terraform driving <a href=https://www.alkira.com/>Alkira Network Cloud</a>.</p>
</div>
<footer class=post-footer>
<div class=post-tags>
<a href=/tags/aws/>aws</a>
<a href=/tags/iaas/>iaas</a>
<a href=/tags/immutability/>immutability</a>
<a href=/tags/linux/>linux</a>
<a href=/tags/terraform/>terraform</a>
<a href=/tags/terraform-cloud/>terraform cloud</a>
<a href=/tags/terraform-modules/>terraform modules</a>
<a href=/tags/ubuntu/>ubuntu</a>
</div>
<nav class=post-nav>
<a class=prev href=/post/2021/getting-started-with-alkira-and-terraform-part-1/>
<i class="iconfont icon-left"></i>
<span class="prev-text nav-default">Getting Started With Alkira And Terraform - (Part 1)</span>
<span class="prev-text nav-mobile">Prev</span>
</a>
<a class=next href=/post/2021/understanding-the-world-of-bitcoin/>
<span class="next-text nav-default">Understanding The World Of Bitcoin</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i>
</a>
</nav>
</footer>
</article>
</div>
</div>
</main>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9QKVT40M3H"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-9QKVT40M3H',{anonymize_ip:!1})}</script>
<footer id=footer class=footer>
<div class=social-links>
<a href=https://twitter.com/wcollins502/ class="iconfont icon-twitter" title=twitter></a>
<a href=https://www.linkedin.com/in/william-collins/ class="iconfont icon-linkedin" title=linkedin></a>
<a href=https://github.com/wcollins/ class="iconfont icon-github" title=github></a>
<a href=http://wcollins.io/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a>
</div>
<div class=copyright>
<span class=copyright-year>
&copy;
2020 -
2022<span class=division> | </span>
<span>William Collins</span>
</span>
</div>
</footer>
<div class=back-to-top id=back-to-top>
<i class="iconfont icon-up"></i>
</div>
</div>
<script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script>
<script type=text/javascript src=/js/main.min.2517c0eb67172a0bae917de4af59b10ca2531411a009d4c0b82f5685259e5771.js></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','G-9QKVT40M3H','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</body>
</html>